{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///C:/Coding/Stream4nzu/lib/api.ts"],"sourcesContent":["// lib/api.ts\nimport axios from 'axios';\n\nexport const API_BASE = 'http://localhost:4000/anime/zoro';\n\n// ============================\n// Tipe Anime yang Diperluas\n// ============================\nexport interface Anime {\n  animeId?: string; \n  mal_id?: string | number; \n  title: string;\n  image?: string; // URL gambar sederhana (dari Consumet)\n  url: string;\n  type: string;\n  episodes?: number;\n  duration?: string;\n  sub?: number;\n  dub?: number;\n  japaneseTitle?: string;\n  nsfw?: boolean;\n\n  // Properti Detail (dari Jikan/MAL)\n  title_english?: string; // BARU: Digunakan di watch page\n  synopsis?: string;      // BARU: Digunakan di watch page\n  score?: number | null; \n  genres?: Array<{ \n    mal_id: number;\n    type: string;\n    name: string;\n    url: string;\n  }>;\n\n  // Struktur gambar kompleks (dibuat opsional agar kompatibel dengan data Consumet)\n  images?: { \n    jpg: {\n      image_url: string;\n      small_image_url?: string; \n      large_image_url?: string; \n    };\n    // Dibuat opsional agar tidak menimbulkan error 2430\n    webp?: { \n      image_url: string;\n      small_image_url: string;\n      large_image_url: string;\n    };\n  };\n}\n\n// ============================\n// Tipe Episode Streaming\n// ============================\n\nexport interface EpisodeLinks {\n  sources: Array<{ url: string; quality?: string; isM3U8?: boolean }>;\n  subtitles: Array<{ url: string; lang?: string }>;\n  animeId: string;\n  episodeId: string;\n}\n\n// ============================\n// Helper function untuk fetch\n// ============================\nasync function fetchAnime(endpoint: string, page: number = 1): Promise<Anime[]> {\n  try {\n    const res = await axios.get(`${API_BASE}/${endpoint}?page=${page}`);\n    const data = res.data?.results || [];\n    return data.map((item: any) => ({\n      animeId: item.id,\n      title: item.title,\n      image: item.image,\n      url: item.url,\n      type: item.type,\n      episodes: item.episodes,\n      duration: item.duration,\n      sub: item.sub,\n      dub: item.dub,\n      japaneseTitle: item.japaneseTitle,\n      nsfw: item.nsfw,\n    }));\n  } catch (err) {\n    console.error(`Error in fetchAnime(${endpoint}):`, err);\n    return [];\n  }\n}\n\n// ============================\n// API functions\n// ============================\n\nexport async function getRecentEpisodes(page: number = 1): Promise<Anime[]> {\n  return fetchAnime('recent-episodes', page);\n}\n\nexport async function getPopularAnime(page: number = 1): Promise<Anime[]> {\n  return fetchAnime('popular', page);\n}\n\nexport async function getTopAnime(page: number = 1): Promise<Anime[]> {\n  return fetchAnime('top', page);\n}\n\nexport async function searchAnime(query: string, page: number = 1): Promise<Anime[]> {\n  try {\n    const res = await axios.get(`${API_BASE}/search?query=${encodeURIComponent(query)}&page=${page}`);\n    const data = res.data?.results || [];\n    return data.map((item: any) => ({\n      animeId: item.id,\n      title: item.title,\n      image: item.image,\n      url: item.url,\n      type: item.type,\n      episodes: item.episodes,\n      duration: item.duration,\n      sub: item.sub,\n      dub: item.dub,\n      japaneseTitle: item.japaneseTitle,\n      nsfw: item.nsfw\n    }));\n  } catch (err) {\n    console.error('Error in searchAnime:', err);\n    return [];\n  }\n}\n\nexport async function getAnimeDetail(animeId: string): Promise<Anime | null> {\n  try {\n    const res = await axios.get(`${API_BASE}/info/${animeId}`);\n    const item = res.data;\n    if (!item) return null;\n\n    // Mapping properti dasar Consumet\n    return {\n      animeId: item.id,\n      title: item.title,\n      image: item.image,\n      url: item.url,\n      type: item.type,\n      episodes: item.episodes,\n      duration: item.duration,\n      sub: item.sub,\n      dub: item.dub,\n      japaneseTitle: item.japaneseTitle,\n      nsfw: item.nsfw,\n      \n      // Jika API /info mengembalikan detail tambahan, map di sini:\n      title_english: item.title_english,\n      synopsis: item.synopsis,\n      // images: item.images, // Tambahkan jika tersedia di respons API\n    };\n  } catch (err) {\n    console.error('Error in getAnimeDetail:', err);\n    return null;\n  }\n}\n\nexport async function getEpisodeStreamingLinks(animeId: string, episodeId: string): Promise<EpisodeLinks | null> {\n    try {\n        const res = await axios.get(`${API_BASE}/watch/${episodeId}`);\n        const data = res.data;\n\n        if (!data || data.sources.length === 0) return null;\n\n        return {\n            sources: data.sources || [],\n            subtitles: data.subtitles || [],\n            animeId: animeId,\n            episodeId: episodeId,\n        } as EpisodeLinks;\n\n    } catch (err) {\n        console.error(`Error fetching streaming links for ${episodeId}:`, err);\n        return null;\n    }\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 241, "column": 0}, "map": {"version":3,"sources":["file:///C:/Coding/Stream4nzu/lib/searchProxy.ts"],"sourcesContent":["import { searchAnime } from '@/lib/api'\r\nimport type { Anime } from '@/lib/api'\r\n\r\nconst cache = new Map<string, Anime[]>()\r\nconst queue: {\r\n  query: string\r\n  resolve: (data: Anime[]) => void\r\n  reject: (err: any) => void\r\n}[] = []\r\nlet processing = false\r\nconst MIN_REQUEST_INTERVAL = 1000 // 1 detik per request\r\n\r\nasync function processQueue() {\r\n  if (processing) return\r\n  processing = true\r\n\r\n  while (queue.length > 0) {\r\n    const { query, resolve, reject } = queue.shift()!\r\n    try {\r\n      if (cache.has(query)) resolve(cache.get(query)!)\r\n      else {\r\n        const data = await searchAnime(query)\r\n        cache.set(query, data.data)\r\n        resolve(data.data)\r\n      }\r\n    } catch (err) {\r\n      reject(err)\r\n    }\r\n    await new Promise((r) => setTimeout(r, MIN_REQUEST_INTERVAL))\r\n  }\r\n\r\n  processing = false\r\n}\r\n\r\nexport function getAnimeSearch(query: string): Promise<Anime[]> {\r\n  return new Promise((resolve, reject) => {\r\n    queue.push({ query, resolve, reject })\r\n    processQueue()\r\n  })\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAGA,MAAM,QAAQ,IAAI;AAClB,MAAM,QAIA,EAAE;AACR,IAAI,aAAa;AACjB,MAAM,uBAAuB,KAAK,sBAAsB;;AAExD,eAAe;IACb,IAAI,YAAY;IAChB,aAAa;IAEb,MAAO,MAAM,MAAM,GAAG,EAAG;QACvB,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE,MAAM,EAAE,GAAG,MAAM,KAAK;QAC9C,IAAI;YACF,IAAI,MAAM,GAAG,CAAC,QAAQ,QAAQ,MAAM,GAAG,CAAC;iBACnC;gBACH,MAAM,OAAO,MAAM,IAAA,2HAAW,EAAC;gBAC/B,MAAM,GAAG,CAAC,OAAO,KAAK,IAAI;gBAC1B,QAAQ,KAAK,IAAI;YACnB;QACF,EAAE,OAAO,KAAK;YACZ,OAAO;QACT;QACA,MAAM,IAAI,QAAQ,CAAC,IAAM,WAAW,GAAG;IACzC;IAEA,aAAa;AACf;AAEO,SAAS,eAAe,KAAa;IAC1C,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC3B,MAAM,IAAI,CAAC;YAAE;YAAO;YAAS;QAAO;QACpC;IACF;AACF"}},
    {"offset": {"line": 285, "column": 0}, "map": {"version":3,"sources":["file:///C:/Coding/Stream4nzu/app/api/search/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\r\nimport { getAnimeSearch } from '@/lib/searchProxy'\r\n\r\nexport async function GET(req: NextRequest) {\r\n  const { searchParams } = new URL(req.url)\r\n  const query = searchParams.get('q')\r\n  if (!query) return NextResponse.json({ error: 'Query required' }, { status: 400 })\r\n\r\n  try {\r\n    const data = await getAnimeSearch(query)\r\n    return NextResponse.json({ data })\r\n  } catch (err: any) {\r\n    console.error('Server proxy search failed:', err)\r\n    return NextResponse.json({ error: err.message || 'Failed to search' }, { status: 500 })\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,IAAI,GAAgB;IACxC,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,IAAI,GAAG;IACxC,MAAM,QAAQ,aAAa,GAAG,CAAC;IAC/B,IAAI,CAAC,OAAO,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE,OAAO;IAAiB,GAAG;QAAE,QAAQ;IAAI;IAEhF,IAAI;QACF,MAAM,OAAO,MAAM,IAAA,sIAAc,EAAC;QAClC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE;QAAK;IAClC,EAAE,OAAO,KAAU;QACjB,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,IAAI,OAAO,IAAI;QAAmB,GAAG;YAAE,QAAQ;QAAI;IACvF;AACF"}}]
}